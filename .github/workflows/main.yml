# ğŸš€ Vue é¡¹ç›®è‡ªåŠ¨åŒ–éƒ¨ç½²å·¥ä½œæµ
name: è‡ªåŠ¨æ„å»ºéƒ¨ç½²Vueé¡¹ç›®

# â° è§¦å‘æ¡ä»¶ï¼šä»£ç æ¨é€è‡³ä¸»åˆ†æ”¯æ—¶è‡ªåŠ¨æ‰§è¡Œ
on:
  push:
    branches: [ "main" ]

# ğŸ”‘ æ‰€éœ€æƒé™é…ç½®
permissions:
  contents: write  # å…è®¸å†™å…¥gh-pagesåˆ†æ”¯

# ğŸ—ï¸ å®šä¹‰å·¥ä½œæµä»»åŠ¡
jobs:
  build-and-deploy:
    name: ã€Œæ„å»ºéƒ¨ç½²ã€å…¨æµç¨‹ä½œä¸š
    runs-on: ubuntu-latest  # ğŸ–¥ï¸ ä½¿ç”¨æœ€æ–°ç‰ˆUbuntuè¿è¡Œå™¨

    # ğŸ“Œ ä»»åŠ¡æ­¥éª¤åˆ†è§£
    steps:
      # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      # ğŸ” æ­¥éª¤1ï¼šä»£ç ä»“åº“åˆå§‹åŒ–
      # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      - name: "ğŸ”— ä»£ç ä»“åº“åˆå§‹åŒ– | Checkout"
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # âš™ï¸ è·å–å®Œæ•´æäº¤å†å²

      # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      # âš™ï¸ æ­¥éª¤2ï¼šNode.jsç¯å¢ƒé…ç½®
      # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      - name: "ğŸ› ï¸ Node.jsç¯å¢ƒé…ç½® | v18 LTS"
        uses: actions/setup-node@v3
        with:
          node-version: "18"  # ğŸ“Œ æŒ‡å®šLTSç‰ˆæœ¬
          cache: "pnpm"       # ğŸ—„ï¸ å¯ç”¨pnpmç¼“å­˜

      # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      # ğŸ“¦ æ­¥éª¤3ï¼šåŒ…ç®¡ç†å™¨å®‰è£…
      # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      - name: "ğŸ“¦ PNPMåŒ…ç®¡ç†å™¨å®‰è£… | v8.x"
        uses: pnpm/action-setup@v2
        with:
          version: 8         # ğŸš€ æŒ‡å®špnpmç‰ˆæœ¬
          run_install: false # ğŸš« ç¦ç”¨è‡ªåŠ¨å®‰è£…

      # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      # ğŸ§© æ­¥éª¤4ï¼šä¾èµ–å®‰è£…ä¸æ„å»º
      # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      - name: "âš¡ ä¾èµ–å®‰è£…ä¸é¡¹ç›®æ„å»º"
        run: |
          echo "â¡ï¸ æ­£åœ¨å®‰è£…é¡¹ç›®ä¾èµ–..."
          pnpm install --frozen-lockfile  # ğŸ§Š ä½¿ç”¨é”å®šæ–‡ä»¶å®‰è£…
          
          echo "ğŸš€ å¼€å§‹æ„å»ºç”Ÿäº§ç¯å¢ƒåŒ…..."
          pnpm build --mode production    # ğŸ—ï¸ æ‰§è¡Œæ„å»ºå‘½ä»¤
          
          echo "âœ… æ„å»ºå®Œæˆï¼ŒæŸ¥çœ‹æ–‡ä»¶ç»“æ„ï¼š"
          ls -lh dist/  # ğŸ“‚ æ˜¾ç¤ºæ„å»ºç›®å½•ç»“æ„

      # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      # ğŸš€ æ­¥éª¤5ï¼šGitHub Pageséƒ¨ç½²
      # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      - name: "ğŸŒ éƒ¨ç½²åˆ°GitHub Pages"
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          branch: gh-pages       # ğŸ¯ ç›®æ ‡åˆ†æ”¯
          folder: dist           # ğŸ“ éƒ¨ç½²ç›®å½•
          clean: true            # ğŸ§¹ æ¸…ç†æ—§æ–‡ä»¶
          single-commit: true    # âœ¨ ä½¿ç”¨å•æ¬¡æäº¤
          commit-message: "ğŸš€ è‡ªåŠ¨éƒ¨ç½²ï¼š$(date -u +'%Y-%m-%dT%H:%M:%SZ')"  # â±ï¸ å¸¦æ—¶é—´æˆ³çš„æäº¤ä¿¡æ¯

