# ğŸš€ Vue é¡¹ç›®è‡ªåŠ¨åŒ–éƒ¨ç½²å·¥ä½œæµ
name: è‡ªåŠ¨æ„å»ºéƒ¨ç½²Vueé¡¹ç›®

# â° è§¦å‘æ¡ä»¶ï¼šä»£ç æ¨é€è‡³ä¸»åˆ†æ”¯æ—¶è‡ªåŠ¨æ‰§è¡Œ
on:
  push:
    branches: [ "main" ]

# ğŸ”‘ æ‰€éœ€æƒé™é…ç½®
permissions:
  contents: write  # å…è®¸å†™å…¥gh-pagesåˆ†æ”¯

# ğŸ—ï¸ å®šä¹‰å·¥ä½œæµä»»åŠ¡
jobs:
  build-and-deploy:
    name: ã€Œæ„å»ºéƒ¨ç½²ã€å…¨æµç¨‹ä½œä¸š
    runs-on: ubuntu-latest  # ğŸ–¥ï¸ ä½¿ç”¨æœ€æ–°ç‰ˆUbuntuè¿è¡Œå™¨

    # ğŸ“Œ ä»»åŠ¡æ­¥éª¤åˆ†è§£
    steps:
      # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      # ğŸ” æ­¥éª¤1ï¼šä»£ç ä»“åº“åˆå§‹åŒ–
      # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      - name: "ğŸ”— ä»£ç ä»“åº“åˆå§‹åŒ– | Checkout"
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # âš™ï¸ è·å–å®Œæ•´æäº¤å†å²

      # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      # ğŸ“¦ æ­¥éª¤2ï¼šå®‰è£… PNPMï¼ˆç§»åˆ°å‰é¢ï¼‰
      # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

      - name: è®¾ç½® Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'  # æŒ‡å®š Node.js ç‰ˆæœ¬


      - name: "ğŸ“¦ PNPMåŒ…ç®¡ç†å™¨å®‰è£… | v8.x"
        uses: pnpm/action-setup@v2
        with:
          version: 8         # ğŸš€ æŒ‡å®špnpmç‰ˆæœ¬

      # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      # ğŸ§© æ­¥éª¤3ï¼šä¾èµ–å®‰è£…ä¸æ„å»º
      # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      - name: "âš¡ ä¾èµ–å®‰è£…ä¸é¡¹ç›®æ„å»º"
        run: |
          echo "â¡ï¸ éªŒè¯ç¯å¢ƒå˜é‡..."
          echo "PATH: $PATH"
          
          echo "â¡ï¸ éªŒè¯å¯æ‰§è¡Œæ–‡ä»¶..."
          which pnpm  # åº”è¯¥è¾“å‡º /opt/hostedtoolcache/pnpm/8.x.x/x64/pnpm
          
          echo "â¡ï¸ æ­£åœ¨å®‰è£…é¡¹ç›®ä¾èµ–..."
          pnpm install --frozen-lockfile
          pnpm build
          ls -lh dist/

      # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      # ğŸš€ æ­¥éª¤4ï¼šGitHub Pageséƒ¨ç½²
      # â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      - name: "ğŸŒ éƒ¨ç½²åˆ°GitHub Pages"
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          branch: gh-pages       # ğŸ¯ ç›®æ ‡åˆ†æ”¯
          folder: dist           # ğŸ“ éƒ¨ç½²ç›®å½•
          clean: true            # ğŸ§¹ æ¸…ç†æ—§æ–‡ä»¶
          single-commit: true    # âœ¨ ä½¿ç”¨å•æ¬¡æäº¤
          commit-message: "ğŸš€ è‡ªåŠ¨éƒ¨ç½²ï¼š$(date -u +'%Y-%m-%dT%H:%M:%SZ')"  # â±ï¸ å¸¦æ—¶é—´æˆ³çš„æäº¤ä¿¡æ¯

